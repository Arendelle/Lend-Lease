# 共享单车租借系统

## 需求分析：

1. 需要储存所有在车棚内储存的单车，每辆单车都有一个独立编号

2. 共享单车有会员制度，只有共享单车的会员用户才可以借车，否则不能借车
3. 用户可以借车，每人每次可以借一辆（如果有特殊规定，每人可以借多辆），但是不能超过一个给定的数量限制
4. 一辆车只能同时被一个人借用
5. 用户用完单车后需要还车，如果超时归还，则根据超时时长计算费用
6. 用户只能还自己借的车，不能还别人借的车
7. 车棚可以补充新的单车，也可以报废旧的单车
8. 如果用户有需要，可以随时加入和退出会员，但是在退出会员前，需要归还所有的已借单车

## 精化策略：

### Base

定义单车类 `Bicycles` 和用户类 `People`，用于描述单车和用户的全体

定义集合 `Garage`，意为在车棚内的单车

定义集合 `Lent`，意为已经被借出的单车集合

定义一个二元组集合 `Lend_Record`，存储借车人与所借车的记录

定义 Event：`借车`，输入变量 `借车人` 和 `单车`

- 检查借车人是否拥有会员资格，单车是否未被租借
- 将单车放入 `Lent` 集合中

定义 Event：`还车`，输入变量 `还车人` 和 `单车`

- 检查还车人是否拥有会员资格，车是否被还车人租借
- 将单车移出 `Lent` 集合
  
### Refine 1 ：借车量限制

定义常量 `LEASE_LIMIT`，表示用户最大借车数量

增加二元组集合，标记某一用户已借车的数量

精化 Event `借车`，只有用户借车数量没有到达 `LEASE_LIMIT`时才允许借车。在借车之后该用户借车数量 `+1`

精化 Event `还车`，还车之后该用户借车数量 `-1`

### Refine 2 ：会员系统

定义集合 `Membership`，意为加入共享单车会员的用户集合

增加 Event `入会`，用于用户加入会员

增加 Event `退会`，用于用户退出会员

- 只有用户当前借车量为 `0`，才可以退出会员

精化 Event `借车`，只有用户属于会员才允许借车

### Refine 3 ：杂项

增加 Event，用于添加新的单车进入车棚

增加 Event，用于报废单车退出车棚

- 报废单车在报废时不能处于被租用状态

增加常量 `DURATION_FREE`，意为免费借车的时长

精化 `LEASE_LIMIT`，添加借车时的时间戳

精化 `还车`，增加还车时间戳参数，当借用时间超出免费借用时长时按照超时时长计算额外费用