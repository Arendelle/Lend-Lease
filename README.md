# 图书租借系统

## 需求分析：

1. 需要储存所有在图书馆内保存的书籍，每本书都有一个独立编号

2. 图书馆有会员制度，只有图书馆的会员用户才可以借书，否则不能借书
3. 用户可以借书，可以借一本也可以借多本，但是不能超过一个给定的数量限制
4. 一本书只能同时被一个人借用
5. 用户阅读完书籍后需要还书，如果超时归还，则根据超时时长计算费用
6. 用户只能还自己借的书，不能还别人借的书
7. 图书馆可以补充新的书籍
8. 如果用户有需要，可以随时加入和退出会员，但是在退出会员前，需要还清所有的已借书籍

## 精化策略：

### Base

定义书籍类 `Books` 和人类 `People`，用于描述书籍和人的全体

定义集合 `Archive`，意为被图书馆收录的书籍

定义集合 `Lent`，意为已经被借出的书籍集合

定义一个二元组集合 `Lend_Record`，存储借书人与所借书的记录

定义 Event：`借书`，输入变量 `借书人` 和 `书`

- 检查借书人是否拥有会员资格，书本是否未被租借
- 将书本放入 `Lent` 集合中

定义 Event：`还书`，输入变量 `还书人` 和 `书`

- 检查还书人是否拥有会员资格，书本是否被还书人租借
- 将书本移出 `Lent` 集合
  
### Refine 1 ：借书量限制

定义常量 `RENT_LIMIT`，表示用户最大借书数量

增加二元组集合，标记某一用户已借书本的数量

精化 Event `借书`，只有用户借书数量没有到达 `RENT_LIMIT`时才允许借书。在借书之后该用户借书数量`+1`

精化 Event `还书`，还书之后该用户借书数量`-1`

### Refine 2 ：会员系统

定义集合 `Membership`，意为加入图书馆会员的用户集合

增加 Event `入会`，用于用户加入会员

增加 Event `退会`，用于用户退出会员

- 只有用户借书量为 `0`，才可以退出会员

精化 Event `借书`，只有用户属于会员才允许借书

### Refine 3 ：杂项

增加 Event，用于添加新的图书进入图书馆

增加 Event，用于报废书籍退出图书馆（待定）

增加常量 `DURATION_FREE`，意为免费借阅的时长

精化 `RENT_LIMIT`，添加借书时的时间戳

精化 `还书`，增加还书时间戳参数，当借阅时间超出免费借阅时长时按照超时时长计算额外费用